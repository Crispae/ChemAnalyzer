(function(S,T,U,V,K,W,H,p,L,M,N,X,Y,O,Z,$,P,I,w,aa,Q,ba,ca,R,da,ea,fa,ga,ha,ia,v,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,j,r){H("J.api");R(J.api,"JmolPropertyManager");H("JV");L(["J.api.JmolPropertyManager","java.util.Hashtable"],"JV.PropertyManager","java.lang.Boolean $.Double $.Float java.util.Arrays $.Date $.Map JU.AU $.BArray $.BS $.Base64 $.Lst $.M3 $.M4 $.P3 $.PT $.SB $.V3 J.api.Interface JM.BondSet $.LabelToken JS.SV $.T JU.BSUtil $.C $.Edge $.Elements $.Escape $.JmolMolecule $.Logger JV.ActionManager $.FileManager $.JC $.Viewer JV.binding.Binding".split(" "),
function(){c$=N(function(){this.map=this.vwr=null;M(this,arguments)},JV,"PropertyManager",null,J.api.JmolPropertyManager);Q(c$,function(){this.map=new java.util.Hashtable});O(c$,function(){});r(c$,"setViewer",function(c){this.vwr=c;for(var b=c=0;c<JV.PropertyManager.propertyTypes.length;c+=3,b++)0<JV.PropertyManager.propertyTypes[c].length&&this.map.put(JV.PropertyManager.propertyTypes[c].toLowerCase(),Integer.$valueOf(b))},"JV.Viewer");r(c$,"getPropertyNumber",function(c){c=this.map.get(null==c?
"":c.toLowerCase());return null==c?-1:c.intValue()},"~S");r(c$,"getDefaultPropertyParam",function(c){return 0>c?"":JV.PropertyManager.propertyTypes[3*c+2]},"~N");r(c$,"checkPropertyParameter",function(c){c=this.getPropertyNumber(c);c=JV.PropertyManager.getParamType(c);return 0<c.length&&"<atom selection>"!==c},"~S");r(c$,"getProperty",function(c,b,e){135!=JV.PropertyManager.propertyTypes.length&&JU.Logger.warn("propertyTypes is not the right length: "+JV.PropertyManager.propertyTypes.length+" != 135");
if(0<=b.indexOf(".")||0<=b.indexOf("[")){var a=this.getArguments(b);e=this.extractProperty(this.getPropertyAsObject(a[0].asString(),e,null),a,1,null,!1)}else e=this.getPropertyAsObject(b,e,c);if(null==c)return e;(a=c.equalsIgnoreCase("readable"))&&(c=JV.PropertyManager.isReadableAsString(b)?"String":"JSON");return c.equalsIgnoreCase("String")?null==e?"":e.toString():a?JU.Escape.toReadable(b,e):c.equalsIgnoreCase("JSON")?JS.SV.safeJSON(b,e):e},"~S,~S,~O");j(c$,"getArguments",function(c){var b=c.toLowerCase(),
e=-1;if(0<=c.indexOf('"')||0<=c.indexOf("'"))c=this.fixSelectQuotes(c);for(;0<=(e=b.indexOf("[select ",++e));){var a=b.indexOf(" where ",e),d=b.indexOf(" wherein ",e);0<d&&d<a&&(a=d);d=b.lastIndexOf("]");0>a||a>d||(c=c.substring(0,e+1)+c.substring(e+1,d).$replace(".","\u0001").$replace("[","\u0002").$replace("]","\u0003")+c.substring(d))}c=JU.PT.rep(JU.PT.rep(c.$replace("]","\x00").$replace("[","\x00"),"..","\u0004").$replace(".","\x00").$replace("\u0001",".").$replace("\u0002","[").$replace("\u0003",
"]"),"\u0004","..");c=JU.PT.rep(c,"\x00\x00","\x00");c=JU.PT.split(JU.PT.trim(c,"\x00"),"\x00");for(var b=Array(c.length),e=0,f;e<c.length;e++)b[e]=c[e].startsWith("'")||c[e].startsWith('"')?JS.SV.newS(JU.PT.trim(c[e],"'\"")):-2147483648==(f=JU.PT.parseInt(c[e]))?JS.SV.newS(c[e]):JS.SV.newI(f);return b},"~S");j(c$,"fixSelectQuotes",function(c){c=c.toCharArray();for(var b=!1,e=!1,a=!1,d=c.length;0<=--d;)switch(c[d]){case "'":a||(b=e=!b);break;case '"':e||(b=a=!b);break;case ".":b&&(c[d]="\u0001");
break;case "[":b&&(c[d]="\u0002");break;case "]":b&&(c[d]="\u0003")}return c=String.instantialize(c)},"~S");r(c$,"extractProperty",function(c,b,e,a,d){0>e&&(b=this.getArguments(b),e=0);if(e>=b.length)return c;d||(b=this.compileSelect(b));var f,g=b[e++];d=JS.SV.oValue(c);switch(g.tok){case 2:f=g.intValue-1;if(p(d,JU.Lst))return 0>f&&(f+=d.size()),0<=f&&f<d.size()?this.extractProperty(d.get(f),b,e,null,!0):"";if(p(d,JU.M3))return a=d,a=v(-1,[w(-1,[a.m00,a.m01,a.m02]),w(-1,[a.m10,a.m11,a.m12]),w(-1,
[a.m20,a.m21,a.m22])]),0>f&&(f+=3),0<=f&&3>f?this.extractProperty(a,b,--e,null,!0):"";if(p(d,JU.M4))return a=d,a=v(-1,[w(-1,[a.m00,a.m01,a.m02,a.m03]),w(-1,[a.m10,a.m11,a.m12,a.m13]),w(-1,[a.m20,a.m21,a.m22,a.m23]),w(-1,[a.m30,a.m31,a.m32,a.m33])]),0>f&&(f+=4),0<=f&&4>f?this.extractProperty(a,b,--e,null,!0):"";if(JU.AU.isAI(d))return 0>f&&(f+=d.length),0<=f&&f<d.length?Integer.$valueOf(d[f]):"";if(JU.AU.isAD(d))return 0>f&&(f+=d.length),0<=f&&f<d.length?Double.$valueOf(d[f]):"";if(JU.AU.isAF(d))return 0>
f&&(f+=d.length),0<=f&&f<d.length?Float.$valueOf(d[f]):"";if(JU.AU.isAII(d)||JU.AU.isAFF(d))return 0>f&&(f+=d.length),0<=f&&f<d.length?this.extractProperty(d[f],b,e,null,!0):"";if(JU.AU.isAS(d)||p(d,Array))return 0>f&&(f+=d.length),0<=f&&f<d.length?d[f]:"";break;case 1275082245:case 4:if(p(d,java.util.Map)){var h=!1,n=c=!1;f=1275082245==g.tok?g.value[0]:null;var k=null;if(1275082245==g.tok)if(n=!0,k=g.value[1],g=g.myName,c=0<=g.indexOf(";"),g.contains("**")){for(var l=0==f.size(),D="",q,m=d.entrySet().iterator();m.hasNext()&&
((q=m.next())||1);)for(var j=q.getKey(),g=l?1:f.size();0<=--g;)if(l||JU.PT.isLike(j,f.get(g))){var h=q.getValue(),s=!1;switch(p(h,JS.SV)?h.tok:0){case 7:s=!0;h=h.getList();break;case 6:case 14:h=h.getMap();break;default:if(!p(h,java.util.Map)&&!(s=p(h,JU.Lst)))h=null}if(null!=h){if(s){null==a&&(a=new JU.Lst);b=h;e=b.size();for(d=0;d<e;d++)if(h=b.get(d),p(h,JS.SV)&&null!=(h=h.getMap()))(null==k||this.vwr.checkSelect(h,k))&&a.addLast(h);return a}if(null==k||this.vwr.checkSelect(h,k))D+=","+j}}if(0==
D.length)return new JU.Lst;g=D.substring(1);h=!c;f=null}else{if(null!=k&&!this.vwr.checkSelect(d,k))return""}else if(g=g.asString(),g.equalsIgnoreCase("keys")){a=new JU.Lst;for(d=d.keySet().iterator();d.hasNext()&&((j=d.next())||1);)a.addLast(j);return this.extractProperty(a,b,e,null,!0)}k=c||0<=g.indexOf(",")||0<=g.indexOf(";");n&&!k&&(k=!0,g+=",");q=c||g.startsWith("*")||g.endsWith("*")||k;j=null!=a;if(q&&(j||(a=new JU.Lst),!c&&(null==f?1==g.length:0==f.size()))){if(e==b.length){if(!j)return d;
a.addLast(d);return a}return this.extractProperty(d,b,e,a,!0)}g.contains("**")&&(g=JU.PT.rep(g,"**","*"));q&&!k&&(g+=",");if(h||c||g.contains(",")){n=new java.util.Hashtable;null!=f&&0==f.size()&&(f=null,g="*");if(null==f){f=JU.PT.split(g,",");for(g=f.length;0<=--g;)JV.PropertyManager.getMapSubset(d,f[g],n,c?a:null)}else for(g=f.size();0<=--g;)JV.PropertyManager.getMapSubset(d,f.get(g),n,c?a:null);if(h&&!j)return n;if(e==b.length){if(!c){if(!j)return n;a.addLast(n)}return a}return this.extractProperty(n,
b,e,j?a:null,!0)}g=this.checkMap(d,g,q,a,b,e,n);return null!=g&&!q?this.extractProperty(d.get(g),b,e,null,!0):!q?"":a}if(p(d,JU.Lst)){null==a&&(a=new JU.Lst);e--;for(f=0;f<d.size();f++)h=d.get(f),(p(h,java.util.Map)||p(h,JU.Lst)||p(h,JS.SV)&&(null!=h.getMap()||null!=h.getList()))&&this.extractProperty(h,b,e,a,!0);return a}}return c},"~O,~O,~N,JU.Lst,~B");c$.getMapSubset=j(c$,"getMapSubset",function(c,b,e,a){if(b.startsWith('"')||b.startsWith("'"))b=JU.PT.trim(b,"\"'");var d=c.get(b);if(null!=d)null==
a?e.put(b,d):a.addLast(d);else{var f;for(c=c.entrySet().iterator();c.hasNext()&&((f=c.next())||1);)d=f.getKey(),JU.PT.isLike(d,b)&&(null==a?e.put(d,f.getValue()):a.addLast(f.getValue()))}},"java.util.Map,~S,java.util.Map,JU.Lst");j(c$,"compileSelect",function(c){for(var b=null,e=c.length;0<=--e;)if(4==c[e].tok){var a=c[e].value,d=a.toUpperCase();if(d.startsWith("SELECT ")){null==b&&(b=JU.AU.arrayCopyObject(c,c.length));d=(a=a.substring(6).trim()).toUpperCase();if(d.startsWith("WHERE ")||d.startsWith("WHEREIN "))d=
(a="* "+a).toUpperCase();var f=d.indexOf(" WHEREIN "),g=0>f?"":0<=a.indexOf(";")?";**":",**";0>f&&(f=d.indexOf(" WHERE "));d=a.substring(0,0>f?a.length:f).trim();d.startsWith("(")&&d.endsWith(")")&&(d=d.substring(1,d.length-1)+";");0>f?b[e]=JS.SV.newV(1275082245,v(-1,[this.getKeys(d),null])):(d+=g,b[e]=JS.SV.newV(1275082245,v(-1,[this.getKeys(d),this.vwr.compileExpr(a.substring(f+6+g.length).trim())])));b[e].myName=d}}return null==b?c:b},"~A");j(c$,"getKeys",function(c){var b=new JU.Lst;c=JU.PT.rep(JU.PT.rep(c,
"**","*"),";",",")+",";for(var e=0,a=-1;0<=(a=c.indexOf(",",a+1));)if(a>e){var d=c.substring(e,a);if(d.equals("*")){if(0==b.size())break}else b.addLast(d),e=a+1}return b},"~S");j(c$,"checkMap",function(c,b,e,a,d,f,g){var h=null==a&&c.containsKey(b);if(!h)for(var n=b.contains(";"),k=n?JU.PT.split(b,";"):null,l=e&&!g?b.toLowerCase():null,j,q=c.keySet().iterator();q.hasNext()&&((j=q.next())||1);){if(n){for(var m=k.length;0<=--m;b=null)if(b=k[m],0!=b.length){if(g){if(!JU.PT.isLike(j,b))continue;break}l=
0<=b.indexOf("*")?b.toLowerCase():null;if(this.checkKey(j,b,l))break}if(null==b)continue}else if(g?!JU.PT.isLike(j,b):!this.checkKey(j,b,l))continue;if(null==a)return j;a.addLast(this.extractProperty(c.get(j),d,f,null,!0));if(!e&&!n)return null}return h?b:null},"java.util.Map,~S,~B,JU.Lst,~O,~N,~B");j(c$,"checkKey",function(c,b,e){return c.equalsIgnoreCase(b)||null!=e&&JU.PT.isLike(c.toLowerCase(),e)},"~S,~S,~S");c$.getPropertyName=j(c$,"getPropertyName",function(c){return 0>c?"":JV.PropertyManager.propertyTypes[3*
c]},"~N");c$.getParamType=j(c$,"getParamType",function(c){return 0>c?"":JV.PropertyManager.propertyTypes[3*c+1]},"~N");c$.isReadableAsString=j(c$,"isReadableAsString",function(c){for(var b=JV.PropertyManager.readableTypes.length;0<=--b;)if(c.equalsIgnoreCase(JV.PropertyManager.readableTypes[b]))return!0;return!1},"~S");j(c$,"getPropertyAsObject",function(c,b,e){if(c.equals("tokenList"))return JS.T.getTokensLike(b);var a=this.getPropertyNumber(c),d=null!=b&&0<b.toString().length;b=d?b:this.getDefaultPropertyParam(a);
switch(a){case 0:return this.getAppletInfo();case 5:return this.getAnimationInfo();case 14:return this.getAllAtomInfo(this.vwr.getAtomBitSet(b));case 24:return this.vwr.getAuxiliaryInfoForAtoms(b);case 15:return this.getAllBondInfo(b);case 25:return this.getBoundBoxInfo();case 10:return this.vwr.tm.fixedRotationCenter;case 16:return this.getAllChainInfo(this.vwr.getAtomBitSet(b));case 37:return this.vwr.getProperty("DATA_API","consoleText",null);case 26:return this.vwr.getDataObj(b.toString(),null,
-1);case 33:return this.vwr.getErrorMessageUn();case 28:return this.vwr.evaluateExpression(b.toString());case 20:return this.vwr.getModelExtract(b,!0,!1,"MOL");case 32:return JV.PropertyManager.getFileInfo(this.vwr.getFileData(),b.toString());case 1:return this.vwr.fm.getFullPathName(!1);case 2:return this.vwr.getFileHeader();case 4:case 3:return d?this.vwr.getFileAsString3(b.toString(),!0,null):this.vwr.getCurrentFileAsString("prop");case 27:return c=b.toString().toLowerCase(),this.getImage(c,0>
c.indexOf("g64")&&0>c.indexOf("base64")&&(null==e||e.equalsIgnoreCase("java")));case 35:return this.vwr.getShapeProperty(24,"info");case 36:return this.vwr.getShapeProperty(24,"data");case 40:return this.vwr.getNMRCalculation().getInfo(b.toString());case 41:return this.getVariables(b.toString());case 21:return this.vwr.getStatusChanged(b.toString());case 22:return this.vwr;case 38:return this.vwr.getJspecViewProperties(b);case 7:return this.getLigandInfo(this.vwr.getAtomBitSet(b));case 9:return this.getMeasurementInfo();
case 29:return this.vwr.getMenu(b.toString());case 23:return this.vwr.sm.messageQueue;case 30:return this.vwr.getMinimizationInfo();case 6:return this.getModelInfo(this.vwr.getAtomBitSet(b));case 18:return this.getMoleculeInfo(this.vwr.getAtomBitSet(b));case 34:return this.getMouseInfo();case 11:return this.vwr.tm.getOrientationInfo();case 31:return this.vwr.ms.getPointGroupInfo(this.vwr.getAtomBitSet(b));case 17:return this.getAllPolymerInfo(this.vwr.getAtomBitSet(b));case 39:return this.vwr.getScriptQueueInfo();
case 8:return this.getShapeInfo();case 19:return this.vwr.getStateInfo3(b.toString(),0,0);case 12:return JU.M3.newM3(this.vwr.tm.matrixRotate);case 42:return this.getAnnotationInfo(b,1073741925);case 43:return this.getAnnotationInfo(b,1073742189);case 44:return b=JS.SV.oValue(b),d=p(b,java.util.Map)?b:null,null==d?null:this.vwr.sm.processService(d)}e=Array(45);for(a=0;45>a;a++){d=JV.PropertyManager.getParamType(a);b=this.getDefaultPropertyParam(a);var f=JV.PropertyManager.getPropertyName(a);e[a]=
0==f.length||"X"==f.charAt(0)?"":f+(""!==d?" "+JV.PropertyManager.getParamType(a)+(""!==b?" #default: "+this.getDefaultPropertyParam(a):""):"")}java.util.Arrays.sort(e);d=new JU.SB;d.append("getProperty ERROR\n").append(c).append("?\nOptions include:\n");for(a=0;45>a;a++)0<e[a].length&&d.append("\n getProperty ").append(e[a]);return d.toString()},"~S,~O,~S");j(c$,"getImage",function(c,b){var e=-1,a=-1,d;if(0<=(d=c.indexOf("height=")))e=JU.PT.parseInt(c.substring(d+7));if(0<=(d=c.indexOf("width=")))a=
JU.PT.parseInt(c.substring(d+6));0>a&&0>e?e=a=-1:0>a?a=e:e=a;var f="JPG";0<=c.indexOf("type=")&&(f=JU.PT.getTokens(JU.PT.replaceWithCharacter(c.substring(c.indexOf("type=")+5),";,"," "))[0]);d=Array(1);e=this.vwr.getImageAsBytes(f.toUpperCase(),a,e,-1,d);return null!=d[0]?d[0]:b?new JU.BArray(e):JU.Base64.getBase64(e).toString()},"~S,~B");j(c$,"getVariables",function(c){return c.toLowerCase().equals("all")?this.vwr.g.getAllVariables():this.vwr.evaluateExpressionAsVariable(c)},"~S");c$.getFileInfo=
j(c$,"getFileInfo",function(c,b){var e=new java.util.Hashtable;if(null==c)return e;var a=null!=b&&0<b.length;if(p(c,java.util.Map))return a?c.get(b):c;var d=JU.PT.split(c,"\n");if(0==d.length||6>d[0].length||" "!=d[0].charAt(6)||!d[0].substring(0,6).equals(d[0].substring(0,6).toUpperCase()))return e.put("fileHeader",c),e;var f="",g=new JU.SB;a&&(b=b.toUpperCase());for(var h="",n=0;n<d.length;n++){var k=d[n];if(!(12>k.length)){var h=k.substring(0,6).trim(),l=k.substring(7,10).trim();h.equals("REMARK")&&
(h+=l);if(!h.equals(f)){if(a&&f.equals(b))return g.toString();a||(e.put(f,g.toString()),g=new JU.SB);f=h}(!a||h.equals(b))&&g.append(k).appendC("\n")}}a||e.put(f,g.toString());return a?h.equals(b)?g.toString():"":e},"~O,~S");j(c$,"getMoleculeInfo",function(c){c=this.vwr.getAtomBitSet(c);for(var b=this.vwr.ms.getMolecules(),e=new JU.Lst,a=new JU.BS,d=0;d<b.length;d++){var a=JU.BSUtil.copy(c),f=b[d];a.and(f.atomList);0<a.length()&&(a=new java.util.Hashtable,a.put("mf",f.getMolecularFormula(!0,null,
!1)),a.put("number",Integer.$valueOf(f.moleculeIndex+1)),a.put("modelNumber",this.vwr.ms.getModelNumberDotted(f.modelIndex)),a.put("numberInModel",Integer.$valueOf(f.indexInModel+1)),a.put("nAtoms",Integer.$valueOf(f.ac)),a.put("nElements",Integer.$valueOf(f.nElements)),e.addLast(a))}return e},"~O");r(c$,"getModelInfo",function(c){c=this.vwr.ms.getModelBS(this.vwr.getAtomBitSet(c),!1);var b=this.vwr.ms,e=new java.util.Hashtable;e.put("modelSetName",b.modelSetName);e.put("modelIndex",Integer.$valueOf(this.vwr.am.cmi));
e.put("modelCount",Integer.$valueOf(b.mc));e.put("isTainted",Boolean.$valueOf(null!=b.tainted));e.put("canSkipLoad",Boolean.$valueOf(b.canSkipLoad));e.put("modelSetHasVibrationVectors",Boolean.$valueOf(b.modelSetHasVibrationVectors()));null!=b.modelSetProperties&&e.put("modelSetProperties",b.modelSetProperties);e.put("modelCountSelected",Integer.$valueOf(c.cardinality()));e.put("modelsSelected",c);var a=new JU.Lst;b.getMolecules();for(var d=c.nextSetBit(0);0<=d;d=c.nextSetBit(d+1)){var f=new java.util.Hashtable;
f.put("_ipt",Integer.$valueOf(d));f.put("num",Integer.$valueOf(b.getModelNumber(d)));f.put("file_model",b.getModelNumberDotted(d));f.put("name",b.getModelName(d));var g=b.getModelTitle(d);null!=g&&f.put("title",g);g=b.getModelFileName(d);null!=g&&f.put("file",g);g=b.getInfo(d,"modelID");null!=g&&f.put("id",g);f.put("vibrationVectors",Boolean.$valueOf(this.vwr.modelHasVibrationVectors(d)));g=b.am[d];f.put("atomCount",Integer.$valueOf(g.act));f.put("bondCount",Integer.$valueOf(g.getBondCount()));f.put("groupCount",
Integer.$valueOf(g.getGroupCount()));f.put("moleculeCount",Integer.$valueOf(g.moleculeCount));g.isBioModel&&f.put("polymerCount",Integer.$valueOf(g.getBioPolymerCount()));f.put("chainCount",Integer.$valueOf(b.getChainCountInModelWater(d,!0)));null!=g.properties&&f.put("modelProperties",g.properties);var h=b.getInfo(d,"Energy");null!=h&&f.put("energy",h);f.put("atomCount",Integer.$valueOf(g.act));a.addLast(f)}e.put("models",a);return e},"~O");r(c$,"getLigandInfo",function(c){var b=this.vwr.getAtomBitSet(c),
e=this.vwr.getAtomBitSet("solvent");c=new java.util.Hashtable;var a=new JU.Lst;c.put("ligands",a);var d=this.vwr.ms,f=JU.BSUtil.copyInvert(b,d.ac);f.or(e);for(var e=d.at,g=b.nextSetBit(0);0<=g;g=b.nextSetBit(g+1))(e[g].group.isProtein()||e[g].group.isDna()||e[g].group.isRna())&&e[g].group.setAtomBitsAndClear(f,b);b=Array(d.mc);for(g=d.mc;0<=--g;)b[g]=this.vwr.getModelUndeletedAtomsBitSet(g),b[g].andNot(f);f=JU.JmolMolecule.getMolecules(e,b,null,f);for(g=0;g<f.length;g++){var b=f[g].atomList,h=new java.util.Hashtable;
a.addLast(h);h.put("atoms",JU.Escape.eBS(b));for(var n="",k="",l=null,j=0,q=null,m="",E="",s=2147483647,u=2147483647,p=b.nextSetBit(0);0<=p;p=b.nextSetBit(p+1)){var t=e[p];if(l!==t.group){var l=t.group,v=t.getResno(),r=t.getChainID();s!=v-1&&(0!=m.length&&s!=u&&(m+="-"+s),r=-1,u=v);E="/"+d.getModelNumberDotted(t.mi);0!=j&&r!=j&&(m+=":"+q+E);-1==r&&(m+=" "+v);s=v;j=t.getChainID();q=t.getChainIDStr();n+=k+t.getGroup3(!1);k="-"}}m+=(u==s?"":"-"+s)+(0==j?"":":"+q)+E;h.put("groupNames",n);h.put("residueList",
m.substring(1))}return c},"~O");r(c$,"getAtomData",function(c,b,e){c.startsWith("{")||(c="{"+c+"}");var a=b.toLowerCase().startsWith("user:"),d=b.toLowerCase().startsWith("property_");e&&(!a&&!d)&&(b=b.toUpperCase());a=d?"%{"+b+"}":a?b.substring(5):b.equals("xyzrn")?"%-2e %8.3x %8.3y %8.3z %4.2[vdw] 1 [%n]%r.%a#%i":b.equals("xyzvib")?"%-2e %10.5x %10.5y %10.5z %10.5vx %10.5vy %10.5vz":b.equals("pdb")?'{selected and not hetero}.label("ATOM  %5i %-4a%1A%3.3n %1c%4R%1E   %8.3x%8.3y%8.3z%6.2Q%6.2b          %2e  ").lines+{selected and hetero}.label("HETATM%5i %-4a%1A%3.3n %1c%4R%1E   %8.3x%8.3y%8.3z%6.2Q%6.2b          %2e  ").lines':
b.equals("xyz")?"%-2e %10.5x %10.5y %10.5z":b.equals("cfi")?"print 'from Jmol"+JV.Viewer.getJmolVersion()+"\n'+{selected}.count + ' ' + {selected}.bonds.count + '\n'   + {selected}.format('%10.0[atomno] %10.0[elemno] %10.4[xyz]')  + {selected}.bonds.format('%i1 %i2') + '\n' + {selected}.bonds.format('%ORDER')":null;if(null==a)return this.getModelExtract(this.vwr.getAtomBitSet(c),!1,!1,b.toUpperCase(),e);if(a.startsWith("print"))return this.vwr.runScript(a);0>a.indexOf("label")?a=c+'.label("'+a+'").lines':
c.equals("selected")||(a=JU.PT.rep(a,"selected",c.substring(1,c.length-1)));return this.vwr.evaluateExpression(a)},"~S,~S,~B");r(c$,"getModelExtract",function(c,b,e,a,d){if(a.equalsIgnoreCase("CIF"))return this.getModelCif(c);if(a.equalsIgnoreCase("CML"))return this.getModelCml(c,2147483647,!0,b,d);if(a.equals("PDB")||a.equals("PQR"))return this.getPdbAtomData(c,null,a.equals("PQR"),b,d);var f=a.equalsIgnoreCase("V3000"),g=a.equalsIgnoreCase("SDF"),h=a.equalsIgnoreCase("MOL"),n=!b&&a.equalsIgnoreCase("XYZVIB"),
k=a.equalsIgnoreCase("XYZRN"),l=a.toUpperCase().startsWith("XYZ"),j=a.equalsIgnoreCase("JSON")||a.equalsIgnoreCase("CD");a=new JU.SB;var q=this.vwr.ms;if(!l&&!j){a.append(e?"Jmol Model Kit":JV.FileManager.fixDOSName(this.vwr.fm.getFullPathName(!1)));e=JV.Viewer.getJmolVersion();a.append("\n__Jmol-").append(e.substring(0,2));var m,p,s,u;u=new Date;e=u.getMonth();m=u.getDate();p=u.getFullYear();s=u.getHours();u=u.getMinutes();JU.PT.rightJustify(a,"_00",""+(1+e));JU.PT.rightJustify(a,"00",""+m);a.append((""+
p).substring(2,4));JU.PT.rightJustify(a,"00",""+s);JU.PT.rightJustify(a,"00",""+u);a.append("3D 1   1.00000     0.00000     0");a.append("\nJmol version ").append(JV.Viewer.getJmolVersion()).append(" EXTRACT: ").append(JU.Escape.eBS(c)).append("\n")}e=JU.BSUtil.copy(c);p=q.at;for(m=c.nextSetBit(0);0<=m;m=c.nextSetBit(m+1))b&&p[m].isDeleted()&&e.clear(m);u=JV.PropertyManager.getCovalentBondsForAtoms(q.bo,q.bondCount,e);if(!n&&e.isEmpty())return"";c=!0;s=this.vwr.ms.getModelBS(e,!0);null!=q.trajectory&&
!d&&q.trajectory.selectDisplayed(s);b=b?this.vwr.tm.getRotationQ():null;if(g){n=a.toString();a=new JU.SB;for(m=s.nextSetBit(0);0<=m;m=s.nextSetBit(m+1)){a.append(n);f=JU.BSUtil.copy(e);f.and(q.getModelAtomBitSetIncludingDeleted(m,!1));u=JV.PropertyManager.getCovalentBondsForAtoms(q.bo,q.bondCount,f);if(!(c=this.addMolFile(m,a,f,u,!1,!1,h,b)))break;a.append("$$$$\n")}}else if(l){h=JM.LabelToken.compile(this.vwr,k?"%-2e _XYZ_ %4.2[vdw] 1 [%n]%r.%a#%i\n":"%-2e _XYZ_\n","\x00",null);g=n?JM.LabelToken.compile(this.vwr,
"%-2e _XYZ_ %12.5vx %12.5vy %12.5vz\n","\x00",null):null;k=new JU.P3;for(m=s.nextSetBit(0);0<=m;m=s.nextSetBit(m+1))if(f=JU.BSUtil.copy(e),f.and(q.getModelAtomBitSetIncludingDeleted(m,!1)),!f.isEmpty()){a.appendI(f.cardinality()).appendC("\n");l=q.am[m].properties;a.append("Model["+(m+1)+"]: ");if(null!=q.frameTitles[m]&&0<q.frameTitles[m].length)a.append(q.frameTitles[m].$replace("\n"," "));else if(null==l)a.append("Jmol "+JV.Viewer.getJmolVersion());else{d=new JU.SB;j=l.propertyNames();for(u=null;j.hasMoreElements();){var r=
j.nextElement();r.equals(".PATH")?u=l.getProperty(r):d.append(";").append(r).append("=").append(l.getProperty(r))}null!=u&&d.append(";PATH=").append(u);u=d.substring(0<d.length()?1:0);a.append(u.$replace("\n"," "))}a.appendC("\n");l=v(-1,[k]);for(d=f.nextSetBit(0);0<=d;d=f.nextSetBit(d+1))j=JM.LabelToken.formatLabelAtomArray(this.vwr,p[d],n&&null!=q.getVibration(d,!1)?g:h,"\x00",null,k),this.getPointTransf(m,q,p[d],b,k),j=JU.PT.rep(j,"_XYZ_",JU.PT.sprintf("%12.5p %12.5p %12.5p","p",l)),a.append(j)}}else c=
this.addMolFile(-1,a,e,u,f,j,h,b);return c?a.toString():"ERROR: Too many atoms or bonds -- use V3000 format."},"JU.BS,~B,~B,~S,~B");j(c$,"getModelCif",function(c){var b=new JU.SB;b.append("# primitive CIF file created by Jmol "+JV.Viewer.getJmolVersion()+"\ndata_primitive");var e=this.vwr.ms.getUnitCellForAtom(c.nextSetBit(0)),a=null==e?w(-1,[1,1,1,90,90,90]):e.getUnitCellAsArray(!1);b.append("\n_cell_length_a ").appendF(a[0]);b.append("\n_cell_length_b ").appendF(a[1]);b.append("\n_cell_length_c ").appendF(a[2]);
b.append("\n_cell_angle_alpha ").appendF(a[3]);b.append("\n_cell_angle_beta ").appendF(a[4]);b.append("\n_cell_angle_gamma ").appendF(a[5]);b.append("\n\n_symmetry_space_group_name_H-M 'P 1'\nloop_\n_space_group_symop_operation_xyz\n'x,y,z'");b.append("\n\nloop_\n_atom_site_label\n_atom_site_fract_x\n_atom_site_fract_y\n_atom_site_fract_z\n");for(var a=this.vwr.ms.at,d=new JU.P3,f=c.nextSetBit(0);0<=f;f=c.nextSetBit(f+1)){var g=a[f];d.setT(g);null!=e&&e.toFractional(d,!1);b.append(g.getElementSymbol()).append("\t").append(JU.PT.formatF(d.x,
10,5,!0,!1)).append("\t").append(JU.PT.formatF(d.y,10,5,!0,!1)).append("\t").append(JU.PT.formatF(d.z,10,5,!0,!1)).append("\n")}return b.toString()},"JU.BS");j(c$,"addMolFile",function(c,b,e,a,d,f,g,h){var n=e.cardinality(),k=a.cardinality();if(!d&&!f&&(999<n||999<k))return!1;var l=this.vwr.ms,j=P(l.ac,0),q=new JU.P3;d?b.append("  0  0  0  0  0  0            999 V3000"):f?b.append('{"mol":{"createdBy":"Jmol '+JV.Viewer.getJmolVersion()+'","a":['):(JU.PT.rightJustify(b,"   ",""+n),JU.PT.rightJustify(b,
"   ",""+k),b.append("  0  0  0  0              1 V2000"));f||b.append("\n");d&&b.append("M  V30 BEGIN CTAB\nM  V30 COUNTS ").appendI(n).append(" ").appendI(k).append(" 0 0 0\n").append("M  V30 BEGIN ATOM\n");for(var k=e.nextSetBit(0),m=0;0<=k;k=e.nextSetBit(k+1))this.getAtomRecordMOL(c,l,b,j[k]=++m,l.at[k],h,q,d,f);d?b.append("M  V30 END ATOM\nM  V30 BEGIN BOND\n"):f&&b.append('],"b":[');k=a.nextSetBit(0);for(m=0;0<=k;k=a.nextSetBit(k+1))this.getBondRecordMOL(b,++m,l.bo[k],j,d,f,g);d&&b.append("M  V30 END BOND\nM  V30 END CTAB\n");
f?b.append("]}}"):b.append("M  END\n");if(!f&&!d&&(c=l.getPartialCharges(),null!=c)){b.append("> <JMOL_PARTIAL_CHARGES>\n").appendI(n).appendC("\n");k=e.nextSetBit(0);for(m=0;0<=k;k=e.nextSetBit(k+1))b.appendI(++m).append(" ").appendF(c[k]).appendC("\n")}return!0},"~N,JU.SB,JU.BS,JU.BS,~B,~B,~B,JU.Quat");c$.getCovalentBondsForAtoms=j(c$,"getCovalentBondsForAtoms",function(c,b,e){for(var a=new JU.BS,d=0;d<b;d++){var f=c[d];e.get(f.atom1.i)&&(e.get(f.atom2.i)&&f.isCovalent())&&a.set(d)}return a},"~A,~N,JU.BS");
j(c$,"getAtomRecordMOL",function(c,b,e,a,d,f,g,h,n){this.getPointTransf(c,b,d,f,g);c=d.getElementNumber();b=d.isDeleted()?"Xx":JU.Elements.elementSymbolFromNumber(c);f=d.getIsotopeNumber();var k=d.getFormalCharge();g=v(-1,[g]);h?(e.append("M  V30 ").appendI(a).append(" ").append(b).append(JU.PT.sprintf(" %12.5p %12.5p %12.5p 0","p",g)),0!=k&&e.append(" CHG=").appendI(k),0!=f&&e.append(" MASS=").appendI(f),e.append("\n")):n?(1!=a&&e.append(","),e.append("{"),6!=d.getElementNumber()&&e.append('"l":"').append(d.getElementSymbol()).append('",'),
0!=k&&e.append('"c":').appendI(k).append(","),0!=f&&f!=JU.Elements.getNaturalIsotope(c)&&e.append('"m":').appendI(f).append(","),e.append('"x":').appendF(d.x).append(',"y":').appendF(d.y).append(',"z":').appendF(d.z).append("}")):(e.append(JU.PT.sprintf("%10.5p%10.5p%10.5p","p",g)),e.append(" ").append(b),1==b.length&&e.append(" "),0<f&&(f-=JU.Elements.getNaturalIsotope(d.getElementNumber())),e.append(" "),JU.PT.rightJustify(e,"  ",""+f),JU.PT.rightJustify(e,"   ",""+(0==k?0:4-k)),e.append("  0  0  0  0\n"))},
"~N,JM.ModelSet,JU.SB,~N,JM.Atom,JU.Quat,JU.P3,~B,~B");j(c$,"getPointTransf",function(c,b,e,a,d){b.isTrajectory(0<=c?c:e.mi)?b.trajectory.getFractional(e,d):d.setT(e);null!=a&&a.transform2(d,d)},"~N,JM.ModelSet,JM.Atom,JU.Quat,JU.P3");j(c$,"getBondRecordMOL",function(c,b,e,a,d,f,g){var h=a[e.atom1.i];a=a[e.atom2.i];var n=e.getValence();3<n&&(n=1);switch(e.order&-131073){case 515:n=f?-3:4;break;case 66:n=f?-3:5;break;case 513:n=f||g?1:6;break;case 514:n=f||g?2:7;break;case 33:n=f?-1:8}d?c.append("M  V30 ").appendI(b).append(" ").appendI(n).append(" ").appendI(h).append(" ").appendI(a).appendC("\n"):
f?(1!=b&&c.append(","),c.append('{"b":').appendI(h-1).append(',"e":').appendI(a-1),1!=n&&(c.append(',"o":'),0>n?c.appendF(-n/2):c.appendI(n)),c.append("}")):(JU.PT.rightJustify(c,"   ",""+h),JU.PT.rightJustify(c,"   ",""+a),c.append("  ").appendI(n).append("  0  0  0\n"))},"JU.SB,~N,JM.Bond,~A,~B,~B,~B");r(c$,"getChimeInfo",function(c,b){switch(c){case 1073741982:break;case 1073741864:return this.getBasePairInfo(b);default:return this.getChimeInfoA(this.vwr.ms.at,c,b)}var e=new JU.SB;this.vwr.getChimeMessenger().getAllChimeInfo(e);
return e.appendC("\n").toString().substring(1)},"~N,JU.BS");j(c$,"getChimeInfoA",function(c,b,e){var a=new JU.SB;a.append("\n");var d="",f=null,g=null,h=-1,n=0;if(null!=e)for(var k=e.nextSetBit(0);0<=k;k=e.nextSetBit(k+1)){var l=c[k];switch(b){default:return"";case 1113589787:d=l.getInfo();break;case 1140850689:d=""+l.getAtomNumber();break;case 1086324742:d=l.getGroup3(!1);break;case 1086326788:case 1073742120:case 1086324744:case 1086324743:var j=l.getChainID(),d=0==j?" ":l.getChainIDStr();300<=
j&&(d=JU.PT.esc(d));switch(b){case 1073742120:d="["+l.getGroup3(!1)+"]"+l.group.getSeqcodeString()+":"+d;break;case 1086324744:case 1086324743:l.mi!=h&&(a.appendC("\n"),n=0,h=l.mi,a.append("Model "+l.getModelNumber()),f=g=null);l.group.chain!==f&&(a.appendC("\n"),n=0,f=l.group.chain,a.append("Chain "+d+":\n"),g=null);d=l.group;d!==g&&(g=d,1086324743==b?a.append(l.getGroup1("?")):(0==n++%5&&1<n&&a.appendC("\n"),JU.PT.leftJustify(a,"          ","["+l.getGroup3(!1)+"]"+l.getResno()+" ")));continue}}0>
a.indexOf("\n"+d+"\n")&&a.append(d).appendC("\n")}1086324744==b&&a.appendC("\n");return a.toString().substring(1)},"~A,~N,JU.BS");r(c$,"getModelFileInfo",function(c){for(var b=this.vwr.ms,e=new JU.SB,a=0;a<b.mc;++a)if(null==c||c.get(a)){var d='["'+b.getModelNumberDotted(a)+'"] = ';e.append("\n\nfile").append(d).append(JU.PT.esc(b.getModelFileName(a)));var f=b.getInfo(a,"modelID");null!=f&&e.append("\nid").append(d).append(JU.PT.esc(f));e.append("\ntitle").append(d).append(JU.PT.esc(b.getModelTitle(a)));
e.append("\nname").append(d).append(JU.PT.esc(b.getModelName(a)));e.append("\ntype").append(d).append(JU.PT.esc(b.getModelFileType(a)))}return e.toString()},"JU.BS");j(c$,"getAllAtomInfo",function(c){for(var b=new JU.Lst,e=new JU.P3,a=c.nextSetBit(0);0<=a;a=c.nextSetBit(a+1))b.addLast(this.getAtomInfoLong(a,e));return b},"JU.BS");j(c$,"getAtomInfoLong",function(c,b){var e=this.vwr.ms,a=e.at[c],d=new java.util.Hashtable;e.getAtomIdentityInfo(c,d,b);d.put("element",e.getElementName(c));d.put("elemno",
Integer.$valueOf(e.at[c].getElementNumber()));d.put("x",Float.$valueOf(a.x));d.put("y",Float.$valueOf(a.y));d.put("z",Float.$valueOf(a.z));d.put("coord",JU.P3.newP(a));null!=e.vibrations&&null!=e.vibrations[c]&&e.vibrations[c].getInfo(d);d.put("bondCount",Integer.$valueOf(a.getCovalentBondCount()));d.put("radius",Float.$valueOf(a.getRasMolRadius()/120));d.put("model",a.getModelNumberForLabel());var f=a.atomPropertyString(this.vwr,1086324748);null!=f&&d.put("shape",f);d.put("visible",Boolean.$valueOf(a.checkVisible()));
d.put("clickabilityFlags",Integer.$valueOf(a.clickabilityFlags));d.put("visibilityFlags",Integer.$valueOf(a.shapeVisibilityFlags));d.put("spacefill",Float.$valueOf(a.getRadius()));f=JU.Escape.escapeColor(this.vwr.gdata.getColorArgbOrGray(a.colixAtom));null!=f&&d.put("color",f);d.put("colix",Integer.$valueOf(a.colixAtom));(f=JU.C.isColixTranslucent(a.colixAtom))&&d.put("translucent",Boolean.$valueOf(f));d.put("formalCharge",Integer.$valueOf(a.getFormalCharge()));d.put("partialCharge",Float.$valueOf(a.getPartialCharge()));
f=a.getSurfaceDistance100()/100;0<=f&&d.put("surfaceDistance",Float.$valueOf(f));if(e.am[a.mi].isBioModel){d.put("resname",a.getGroup3(!1));var f=a.group.getInsertionCode(),g=a.getResno();0<g&&d.put("resno",Integer.$valueOf(g));0!=f.charCodeAt(0)&&d.put("insertionCode",""+f);d.put("name",e.at[c].getAtomName());d.put("chain",a.getChainIDStr());d.put("atomID",Integer.$valueOf(a.atomID));d.put("groupID",Integer.$valueOf(a.group.groupID));"\x00"!=a.altloc&&d.put("altLocation",""+a.altloc);d.put("structure",
Integer.$valueOf(a.group.getProteinStructureType().getId()));d.put("polymerLength",Integer.$valueOf(a.group.getBioPolymerLength()));d.put("occupancy",Integer.$valueOf(a.getOccupancy100()));e=a.getBfactor100();d.put("temp",Integer.$valueOf(K(e/100)))}return d},"~N,JU.P3");j(c$,"getAllBondInfo",function(c){var b=new JU.Lst,e=this.vwr.ms,a=e.bondCount,e=e.bo,d;p(c,String)&&(c=this.vwr.getAtomBitSet(c));var f=new JU.P3;if(p(c,Array)){d=c[0];var g=c[1];for(c=0;c<a;c++){var h=e[c].atom1.i,j=e[c].atom2.i;
(d.get(h)&&g.get(j)||g.get(h)&&d.get(j))&&b.addLast(this.getBondInfo(c,f))}}else if(p(c,JM.BondSet)){d=c;for(c=d.nextSetBit(0);0<=c&&c<a;c=d.nextSetBit(c+1))b.addLast(this.getBondInfo(c,f))}else if(p(c,JU.BS)){d=c;g=1==d.cardinality()?d.nextSetBit(0):-1;for(c=0;c<a;c++)(0<=g?e[c].atom1.i==g||e[c].atom2.i==g:d.get(e[c].atom1.i)&&d.get(e[c].atom2.i))&&b.addLast(this.getBondInfo(c,f))}return b},"~O");j(c$,"getBondInfo",function(c,b){var e=this.vwr.ms.bo[c],a=e.atom1,d=e.atom2,f=new java.util.Hashtable;
f.put("_bpt",Integer.$valueOf(c));var g=new java.util.Hashtable;this.vwr.ms.getAtomIdentityInfo(a.i,g,b);var h=new java.util.Hashtable;this.vwr.ms.getAtomIdentityInfo(d.i,h,b);f.put("atom1",g);f.put("atom2",h);f.put("jmol_order","0x"+Integer.toHexString(e.order));f.put("order",Float.$valueOf(JU.PT.fVal(JU.Edge.getBondOrderNumberFromOrder(e.order))));f.put("type",JU.Edge.getBondOrderNameFromOrder(e.order));f.put("radius",Float.$valueOf(e.mad/2E3));f.put("length_Ang",Float.$valueOf(a.distance(d)));
f.put("visible",Boolean.$valueOf(0!=e.shapeVisibilityFlags));a=JU.Escape.escapeColor(this.vwr.gdata.getColorArgbOrGray(e.colix));null!=a&&f.put("color",a);f.put("colix",Integer.$valueOf(e.colix));JU.C.isColixTranslucent(e.colix)&&f.put("translucent",Boolean.TRUE);return f},"~N,JU.P3");j(c$,"getAllChainInfo",function(c){for(var b=new java.util.Hashtable,e=new JU.Lst,a=this.vwr.ms.mc,d=0;d<a;++d){var f=new java.util.Hashtable,g=this.getChainInfo(d,c);0<g.size()&&(f.put("modelIndex",Integer.$valueOf(d)),
f.put("chains",g),e.addLast(f))}b.put("models",e);return b},"JU.BS");j(c$,"getChainInfo",function(c,b){for(var e=this.vwr.ms.am[c],a=e.getChainCount(!0),d=new JU.Lst,f=new JU.P3,g=0;g<a;g++){for(var h=e.getChainAt(g),j=new JU.Lst,k=h.groupCount,l=new java.util.Hashtable,p=0;p<k;p++){var q=h.groups[p];b.get(q.firstAtomIndex)&&j.addLast(q.getGroupInfo(p,f))}j.isEmpty()||(l.put("residues",j),d.addLast(l))}return d},"~N,JU.BS");j(c$,"getAllPolymerInfo",function(c){var b=new java.util.Hashtable;null!=
this.vwr.ms.bioModelset&&this.vwr.ms.bioModelset.getAllPolymerInfo(c,b);return b},"JU.BS");j(c$,"getBasePairInfo",function(c){var b=new JU.SB,e=new JU.Lst;this.vwr.ms.calcRasmolHydrogenBonds(c,c,e,!0,1,!1,null);for(c=e.size();0<=--c;){var a=e.get(c);JV.PropertyManager.getAtomResidueInfo(b,a.atom1);b.append(" - ");JV.PropertyManager.getAtomResidueInfo(b,a.atom2);b.append("\n")}return b.toString()},"JU.BS");c$.getAtomResidueInfo=j(c$,"getAtomResidueInfo",function(c,b){c.append("[").append(b.getGroup3(!1)).append("]").append(b.group.getSeqcodeString()).append(":");
var e=b.getChainID();c.append(0==e?" ":b.getChainIDStr())},"JU.SB,JM.Atom");j(c$,"getAppletInfo",function(){var c=new java.util.Hashtable;c.put("htmlName",this.vwr.htmlName);c.put("syncId",this.vwr.syncId);c.put("fullName",this.vwr.fullName);c.put("codeBase",""+JV.Viewer.appletCodeBase);this.vwr.isApplet&&(c.put("documentBase",JV.Viewer.appletDocumentBase),c.put("registry",this.vwr.sm.getRegistryInfo()));c.put("version",JV.JC.version);c.put("date",JV.JC.date);c.put("javaVendor",JV.Viewer.strJavaVendor);
c.put("javaVersion",JV.Viewer.strJavaVersion+(!this.vwr.isJS?"":this.vwr.isWebGL?"(WebGL)":"(HTML5)"));c.put("operatingSystem",JV.Viewer.strOSName);return c});j(c$,"getAnimationInfo",function(){var c=this.vwr.am,b=new java.util.Hashtable;b.put("firstModelIndex",Integer.$valueOf(c.firstFrameIndex));b.put("lastModelIndex",Integer.$valueOf(c.lastFrameIndex));b.put("animationDirection",Integer.$valueOf(c.animationDirection));b.put("currentDirection",Integer.$valueOf(c.currentDirection));b.put("displayModelIndex",
Integer.$valueOf(c.cmi));null!=c.animationFrames&&(b.put("isMovie",Boolean.TRUE),b.put("frames",JU.Escape.eAI(c.animationFrames)),b.put("currentAnimationFrame",Integer.$valueOf(c.caf)));b.put("displayModelNumber",this.vwr.getModelNumberDotted(c.cmi));b.put("displayModelName",0<=c.cmi?this.vwr.getModelName(c.cmi):"");b.put("animationFps",Integer.$valueOf(c.animationFps));b.put("animationReplayMode",JS.T.nameOf(c.animationReplayMode));b.put("firstFrameDelay",Float.$valueOf(c.firstFrameDelay));b.put("lastFrameDelay",
Float.$valueOf(c.lastFrameDelay));b.put("animationOn",Boolean.$valueOf(c.animationOn));b.put("animationPaused",Boolean.$valueOf(c.animationPaused));return b});j(c$,"getBoundBoxInfo",function(){var c=this.vwr.ms.getBoxInfo(null,1).getBoundBoxPoints(!0),b=new java.util.Hashtable;b.put("center",JU.P3.newP(c[0]));b.put("vector",JU.V3.newV(c[1]));b.put("corner0",JU.P3.newP(c[2]));b.put("corner1",JU.P3.newP(c[3]));return b});j(c$,"getShapeInfo",function(){var c=new java.util.Hashtable,b=new JU.SB,e=this.vwr.shm.shapes;
if(null!=e)for(var a=0;37>a;++a){var d=e[a];if(null!=d){var f=JV.JC.shapeClassBases[a],d=d.getShapeDetail();null!=d&&c.put(f,d)}}0<b.length()&&c.put("shapeCommands",b.toString());return c});j(c$,"getAnnotationInfo",function(c,b){var e=this.vwr.getAtomBitSet(c),e=this.vwr.ms.getModelBS(e,!1).nextSetBit(0);if(0>e)return null;var a=this.vwr.ms.getModelAuxiliaryInfo(e).get(1073741925==b?"domains":"validation");if(null==a||6!=a.tok)return null;this.vwr.getAnnotationParser(!1).initializeAnnotation(a,b,
e);return a.mapGet("_list")},"~O,~N");j(c$,"getMeasurementInfo",function(){return this.vwr.getShapeProperty(6,"info")});j(c$,"getMouseInfo",function(){if(!this.vwr.haveDisplay)return null;for(var c=new java.util.Hashtable,b=new JU.Lst,e=this.vwr.acm,a,d=e.b.getBindings().values().iterator();d.hasNext()&&((a=d.next())||1);)p(a,Boolean)||(JU.AU.isAI(a)&&(a=v(-1,[JV.binding.Binding.getMouseActionName(a[0],!1),JV.ActionManager.getActionName(a[1])])),b.addLast(a));c.put("bindings",b);c.put("bindingName",
e.b.name);c.put("actionNames",JV.ActionManager.actionNames);c.put("actionInfo",JV.ActionManager.actionInfo);c.put("bindingInfo",JU.PT.split(e.getBindingInfo(null),"\n"));return c});r(c$,"getPdbAtomData",function(c,b,e,a){if(0==this.vwr.ms.ac||0>c.nextSetBit(0))return"";null==b?b=this.vwr.getOutputChannel(null,null):(e=(new Boolean(e|0<=b.getType().indexOf("PQR"))).valueOf(),a=(new Boolean(a|0<=b.getType().indexOf("-coord true"))).valueOf());var d=this.vwr.ms.at,f=this.vwr.ms.am,g=d[c.nextSetBit(0)].mi,
h=-1,j=!1,k="%6.2Q%6.2b          ";if(e){var k="%8.4P%7.4V       ",l=0;for(e=c.nextSetBit(0);0<=e;e=c.nextSetBit(e+1))l+=d[e].getPartialCharge();b.append("REMARK   1 PQR file generated by Jmol "+JV.Viewer.getJmolVersion()).append("\nREMARK   1 created "+new java.util.Date).append("\nREMARK   1 Forcefield Used: unknown\nREMARK   1").append("\nREMARK   5").append("\nREMARK   6 Total charge on this protein: "+l+" e\nREMARK   6\n")}e=c.length()-1;var p=g!=d[e].mi,q=new JU.Lst,g=f[g].isPdbWithMultipleBonds,
m,r=new JU.P3,s=v(-1,[r]),u=a?this.vwr.tm.getRotationQ():null;for(e=c.nextSetBit(0);0<=e;e=c.nextSetBit(e+1))a=d[e],j=f[a.mi].isBioModel,p&&a.mi!=h&&(-1!=h&&b.append("ENDMDL\n"),h=a.mi,b.append("MODEL     "+(h+1)+"\n"),q=new JU.Lst),l=a.getAtomName(),m=2==a.getElementSymbol().length||4<=l.length||JU.PT.isDigit(l.charAt(0)),l=a.isHetero(),m=j?l?m?JM.LabelToken.compile(this.vwr,"HETATM%5.-5i %-4.4a%1A%3.3n %1c%4.-4R%1E   _XYZ_"+k,"\x00",null):JM.LabelToken.compile(this.vwr,"HETATM%5.-5i  %-3.3a%1A%3.3n %1c%4.-4R%1E   _XYZ_"+
k,"\x00",null):m?JM.LabelToken.compile(this.vwr,"ATOM  %5.-5i %-4.4a%1A%3.3n %1c%4.-4R%1E   _XYZ_"+k,"\x00",null):JM.LabelToken.compile(this.vwr,"ATOM  %5.-5i  %-3.3a%1A%3.3n %1c%4.-4R%1E   _XYZ_"+k,"\x00",null):m?JM.LabelToken.compile(this.vwr,"HETATM%5.-5i %-4.4a%1AUNK %1c   1%1E   _XYZ_"+k,"\x00",null):JM.LabelToken.compile(this.vwr,"HETATM%5.-5i  %-3.3a%1AUNK %1c   1%1E   _XYZ_"+k,"\x00",null),l=a.getElementSymbolIso(!1).toUpperCase(),l=this.pdbKey(a.group.getBioPolymerIndexInModel())+this.pdbKey(a.group.groupIndex)+
JM.LabelToken.formatLabelAtomArray(this.vwr,a,m,"\x00",null,r)+(1==l.length?" "+l:l.substring(0,2))+"  ",this.getPointTransf(-1,this.vwr.ms,a,u,r),a=JU.PT.sprintf("%8.3p%8.3p%8.3p","p",s),24<a.length&&(a=JU.PT.sprintf("%8.2p%8.2p%8.2p","p",s)),l=JU.PT.rep(l,"_XYZ_",a),q.addLast(l);f=new java.util.Hashtable;this.fixPDBFormat(q,f,b);if(p)b.append("ENDMDL\n");else for(e=c.nextSetBit(0);0<=e;e=c.nextSetBit(e+1))if(a=d[e],l=!j||a.isHetero(),h=!l&&16==a.getElementNumber(),l||g||h)if(k=a.bonds,null!=k)for(p=
0;p<k.length;p++)if(r=a.getAtomNumber(),s=k[p].getOtherAtom(a),c.get(s.i)&&(q=k[p].getCovalentOrder(),!(1==q&&(g&&!l&&!h||h&&16!=s.getElementNumber()))))switch(s=s.getAtomNumber(),q){case 2:case 3:if(s<r)continue;case 1:b.append("CONECT").append(JU.PT.formatStringS("%5s","s",""+f.get(Integer.$valueOf(r))));r=JU.PT.formatStringS("%5s","s",""+f.get(Integer.$valueOf(s)));for(s=0;s<q;s++)b.append(r);b.append("\n")}return b.toString()},"JU.BS,JU.OC,~B,~B,~B");j(c$,"pdbKey",function(c){c=0>c?"!999":"   "+
c;return c.substring(c.length-4)},"~N");j(c$,"fixPDBFormat",function(c,b,e){c.addLast("!999!999XXXXXX99999999999999999999!99!");var a=Array(c.size());c.toArray(a);java.util.Arrays.sort(a);c.clear();for(var d=0,f=a.length;d<f;d++)c.addLast(a[d]);for(var g=a=null,f=c.size(),d=0;d<f;d++){var h=c.get(d),j=h.substring(0,4),h=h.substring(8),k=!1,l=0<=h.indexOf("!99!");if(!j.equals(a)||l)null!=a&&!a.equals("!999")&&(k=!0,h="TER   "+g.substring(6,11)+"      "+g.substring(17,27),c.add(d,j+"!!!!"+h),f++),a=
j;if(l&&!k)break;g=h;null!=b&&!k&&b.put(Integer.$valueOf(JU.PT.parseInt(h.substring(6,11))),Integer.$valueOf(d+1));j="     "+(d+1);e.append(h.substring(0,6)).append(j.substring(j.length-5)).append(h.substring(11)).append("\n")}},"JU.Lst,java.util.Map,JU.OC");r(c$,"getPdbData",function(c,b,e,a,d,f){this.vwr.ms.isJmolDataFrameForModel(c)&&(c=this.vwr.ms.getJmolDataSourceFrame(c));if(0>c)return"";var g=this.vwr.ms.am[c],h=g.isBioModel;if(null==a&&!h)return null;null==d&&(d=this.vwr.getOutputChannel(null,
null));var j=new JU.SB,k=0<=b.indexOf("draw"),l=null,p=new JU.BS,q="\x00",m=this.vwr.ms.getLabeler().compile(this.vwr,"ATOM  %-6i%4a%1A%3.-3n %1c%4R%1E   ","\x00",null);if(null==a)q=11<b.length&&0<=b.indexOf("quaternion ")?b.charAt(11):"R",g.getPdbData(b,q,k,e,d,m,j,p),l=this.vwr.getModelUndeletedAtomsBitSet(c);else{l=a[0];c=a[1];var g=a[2],r=a[3],s=null!=g,u=null!=r,y=a[4],t=a[5],z=a[6],C=a[7],A=a[8],B=a[9];a=null!=z&&null==A;var F=this.vwr.ms.at;if(a){d.append("REMARK   6 Jmol PDB-encoded data: ").append(b).append("; ").append(JV.Viewer.getJmolVersion()).append("; ").append(this.vwr.apiPlatform.getDateFormat(null)).append("\n");
d.append("REMARK   6 Jmol data").append(" min = ").append(JU.Escape.eP(y)).append(" max = ").append(JU.Escape.eP(t)).append(" unScaledXyz = xyz * ").append(JU.Escape.eP(z)).append(" + ").append(JU.Escape.eP(C)).append(";\n");t=null;for(b=l.nextSetBit(0);0<=b;b=l.nextSetBit(b+1))if(y=""+F[b].getAtomName(),null!=t||4<y.length)null==t?(t="",b=-1):t+=" "+y;null!=t&&d.append("REMARK   6 Jmol atom names").append(t).append("\n");t=null;for(b=l.nextSetBit(0);0<=b;b=l.nextSetBit(b+1))if(y=""+F[b].getGroup3(!0),
null!=t||3<y.length)null==t?(t="",b=-1):t+=" "+y;null!=t&&d.append("REMARK   6 Jmol residue names").append(t).append("\n");for(b=0;b<B.length;b++)null!=B[b]&&d.append("REMARK   6 Jmol property ").append(B[b]).append(";\n")}B=null;y=new JU.P3;a||(null==A&&(A="%-5i %-10s %-13.5f "+(u?"%-13.5f %-13.5f":s?"%-13.5f":"")),A+="\n");b=l.nextSetBit(0);for(t=0;0<=b;b=l.nextSetBit(b+1),t++){var z=c[t],C=s?g[t]:0,G=u?r[t]:0;if(!Float.isNaN(z)&&!Float.isNaN(C)&&!Float.isNaN(G)){var x=F[b];a?(d.append(JM.LabelToken.formatLabelAtomArray(this.vwr,
x,m,"\x00",null,y)),h&&p.set(b),d.append(JU.PT.sprintf("%-8.2f%-8.2f%-10.2f    %6.3f          %2s    %s\n","ssF",v(-1,[x.getElementSymbolIso(!1).toUpperCase(),"",w(-1,[z,C,G,0])]))),null!=B&&B.group.getBioPolymerIndexInModel()==x.group.getBioPolymerIndexInModel()&&j.append("CONECT").append(JU.PT.formatStringI("%5i","i",B.getAtomNumber())).append(JU.PT.formatStringI("%5i","i",x.getAtomNumber())).appendC("\n")):u?d.append(JU.PT.sprintf(A,"isF",v(-1,[Integer.$valueOf(x.getAtomNumber()),x.getAtomName(),
w(-1,[z,C,G])]))):s?d.append(JU.PT.sprintf(A,"isF",v(-1,[Integer.$valueOf(x.getAtomNumber()),x.getAtomName(),w(-1,[z,C])]))):d.append(JU.PT.sprintf(A,"isF",v(-1,[Integer.$valueOf(x.getAtomNumber()),x.getAtomName(),w(-1,[z])])));B=x}}}d.append(j.toString());if(k)return d.toString();e.and(l);h&&f&&d.append("\n\n"+this.vwr.ms.getProteinStructureState(p,"R"==q?4138:1073742086));return d.toString()},"~N,~S,JU.BS,~A,JU.OC,~B");r(c$,"getModelCml",function(c,b,e){var a=new JU.SB;if(0==c.cardinality())return"";
this.vwr.isJS&&J.api.Interface.getInterface("JU.XmlUtil",this.vwr,"file");JU.XmlUtil.openTag(a,"molecule");JU.XmlUtil.openTag(a,"atomArray");for(var d=new JU.BS,f=this.vwr.ms.at,g=c.nextSetBit(0);0<=g&&!(0>--b);g=c.nextSetBit(g+1)){var h=f[g],j=h.getAtomName();JU.PT.rep(j,'"',"''");d.set(h.i);JU.XmlUtil.appendTag(a,"atom/",v(-1,["id","a"+(h.i+1),"title",h.getAtomName(),"elementType",h.getElementSymbol(),"x3",""+h.x,"y3",""+h.y,"z3",""+h.z]))}JU.XmlUtil.closeTag(a,"atomArray");if(e){JU.XmlUtil.openTag(a,
"bondArray");c=this.vwr.ms.bondCount;b=this.vwr.ms.bo;for(g=0;g<c;g++)e=b[g],f=e.atom2,d.get(e.atom1.i)&&d.get(f.i)&&(f=JU.Edge.getCmlBondOrder(e.order),null!=f&&JU.XmlUtil.appendTag(a,"bond/",v(-1,["atomRefs2","a"+(e.atom1.i+1)+" a"+(e.atom2.i+1),"order",f])));JU.XmlUtil.closeTag(a,"bondArray")}JU.XmlUtil.closeTag(a,"molecule");return a.toString()},"JU.BS,~N,~B,~B,~B");I(c$,"atomExpression","<atom selection>");c$.propertyTypes=c$.prototype.propertyTypes=v(-1,"appletInfo;;;fileName;;;fileHeader;;;fileContents;<pathname>;;fileContents;;;animationInfo;;;modelInfo;<atom selection>;{*};ligandInfo;<atom selection>;{*};shapeInfo;;;measurementInfo;;;centerInfo;;;orientationInfo;;;transformInfo;;;;;;atomInfo;<atom selection>;(visible);bondInfo;<atom selection>;(visible);chainInfo;<atom selection>;(visible);polymerInfo;<atom selection>;(visible);moleculeInfo;<atom selection>;(visible);stateInfo;<state type>;all;extractModel;<atom selection>;(visible);jmolStatus;statusNameList;;jmolViewer;;;messageQueue;;;auxiliaryInfo;<atom selection>;{*};boundBoxInfo;;;dataInfo;<data type>;types;image;<width=www,height=hhh>;;evaluate;<expression>;;menu;<type>;current;minimizationInfo;;;pointGroupInfo;<atom selection>;(visible);fileInfo;<type>;;errorMessage;;;mouseInfo;;;isosurfaceInfo;;;isosurfaceData;;;consoleText;;;JSpecView;<key>;;scriptQueueInfo;;;nmrInfo;<elementSymbol> or 'all' or 'shifts';all;variableInfo;<name>;all;domainInfo;<atom selection>;{visible};validationInfo;<atom selection>;{visible};service;<hashTable>;".split(";"));
I(c$,"PROP_APPLET_INFO",0,"PROP_FILENAME",1,"PROP_FILEHEADER",2,"PROP_FILECONTENTS_PATH",3,"PROP_FILECONTENTS",4,"PROP_ANIMATION_INFO",5,"PROP_MODEL_INFO",6,"PROP_LIGAND_INFO",7,"PROP_SHAPE_INFO",8,"PROP_MEASUREMENT_INFO",9,"PROP_CENTER_INFO",10,"PROP_ORIENTATION_INFO",11,"PROP_TRANSFORM_INFO",12,"PROP_ATOM_INFO",14,"PROP_BOND_INFO",15,"PROP_CHAIN_INFO",16,"PROP_POLYMER_INFO",17,"PROP_MOLECULE_INFO",18,"PROP_STATE_INFO",19,"PROP_EXTRACT_MODEL",20,"PROP_JMOL_STATUS",21,"PROP_JMOL_VIEWER",22,"PROP_MESSAGE_QUEUE",
23,"PROP_AUXILIARY_INFO",24,"PROP_BOUNDBOX_INFO",25,"PROP_DATA_INFO",26,"PROP_IMAGE",27,"PROP_EVALUATE",28,"PROP_MENU",29,"PROP_MINIMIZATION_INFO",30,"PROP_POINTGROUP_INFO",31,"PROP_FILE_INFO",32,"PROP_ERROR_MESSAGE",33,"PROP_MOUSE_INFO",34,"PROP_ISOSURFACE_INFO",35,"PROP_ISOSURFACE_DATA",36,"PROP_CONSOLE_TEXT",37,"PROP_JSPECVIEW",38,"PROP_SCRIPT_QUEUE_INFO",39,"PROP_NMR_INFO",40,"PROP_VAR_INFO",41,"PROP_DOM_INFO",42,"PROP_VAL_INFO",43,"PROP_SERVICE",44,"PROP_COUNT",45,"readableTypes",v(-1," stateinfo extractmodel filecontents fileheader image menu minimizationInfo".split(" ")))})})(Clazz,
Clazz.getClassName,Clazz.newLongArray,Clazz.doubleToByte,Clazz.doubleToInt,Clazz.doubleToLong,Clazz.declarePackage,Clazz.instanceOf,Clazz.load,Clazz.instantialize,Clazz.decorateAsClass,Clazz.floatToInt,Clazz.floatToLong,Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,Clazz.declareType,Clazz.prepareFields,Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,
Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,Clazz.superCall,Clazz.decorateAsType,Clazz.newBooleanArray,Clazz.newCharArray,Clazz.implementOf,Clazz.newDoubleArray,Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAB,Clazz.isAI,Clazz.isAS,Clazz.isASS,Clazz.isAP,Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs,Clazz.alert,
Clazz.defineMethod,Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.cloneFinals);
